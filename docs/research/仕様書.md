# TNF Maternity+ 2025FW｜Astro + Tailwind v4 仕様書

この文書は、提示いただいたLP（1カラム縦長）を **Astro + Tailwind CSS v4** で実装するための実装仕様です。レイアウトグリッド、各セクションの要素・サイズ感、配色、共通コンポーネント、データ構造、背景アニメーション（木漏れ日のような“木の陰が揺れる”表現）までを網羅します。

---

## 1. 全体方針 / IA（Information Architecture）

### 1.1 レイアウト特性

- 1カラム縦長、**セクションごとに背景色（生成り/藍/テラコッタ）**を切り替え、視覚的な区切りを強調。
- 主要モジュール：
  1. **Hero**（家族ビジュアル＋ロゴ＋グローナビ極小）
  2. **イントロコピー**（手書き風ラベル）
  3. **ハイライトギャラリー**（3〜4枚横グリッド／スマホはスワイプ）
  4. **製品ライン導入バナー**（Product Lines）
  5. **2025FW コレクションセクション**（商品のカードカルーセル×複数段）
  6. **アイテム一覧導線 & スタッフスタイリング導線**（2ボタン）
  7. **ベビーブランケット・コレクション**（小カード×4）
  8. **ピックアップ製品カード 3列**
  9. **ファミリー写真（フルブリード）**
  10. **フッター（2CTA + 会社情報）**

### 1.2 ブレイクポイント & コンテナ

- 想定基準：
  - **Mobile**: 360–480px（基準 390）
  - **Tablet**: 768px
  - **Desktop**: 1280–1440px（基準 1360 コンテナ）
- コンテナ幅（padding 含まず）
  - `sm`: fluid（左右16px padding）
  - `md`: 672px
  - `lg`: 960px
  - `xl`: 1160px
  - `2xl`: 1280px（最大）
- ページ左右パディング：`sm:16px / md:24px / lg+: 32px`

### 1.3 余白スケール（Tailwind spacing）

- 4px グリッド。
- キー値：`2, 4, 6, 8, 12, 16, 20, 24, 32, 40, 48, 56, 64, 80, 96`。
- セクション上下マージン：
  - `sm: 56–64px`, `md: 80px`, `lg+: 96–128px`。

---

## 2. カラーパレット（global.css で集中管理 / Tailwind v4 @theme）

> **Tailwind v4 前提**：`@theme` でトークンを定義し、`bg-[token]`/`text-[token]`/`border-[token]` を使用。

- キーカラー（目視抽出）：
  - **深藍（ブランドネイビー）**: `#0e2540`
  - **生成り（ライトベージュ）**: `#efe5d6`
  - **紙色（もう少し濃いベージュ）**: `#e7dac5`
  - **テラコッタ（土壁/背景）**: `#9c6a4a`
  - **TNFブルー（アクセント）**: `#1e75bb`
  - **サブグレー**: `#6b6b6b`
  - **テキスト濃色**: `#1a1a1a`
  - **ホワイト**: `#ffffff`
  - **ブラック**: `#000000`
- 透明影・カード影用：`rgba(0,0,0,.06)`, `rgba(0,0,0,.12)`。

**global.css（抜粋）** は本書末尾 §8 に掲載。

---

## 3. タイポグラフィ

### 3.1 使用フォント（25FW）

**和文：**

- **Noto Sans JP Bold** - 見出し・強調テキスト用
- **Noto Sans JP Medium** - 本文・通常テキスト用
- フォントURL: https://fonts.google.com/noto/specimen/Noto+Sans+JP

**欧文：**

- **Lexend Thin** - 繊細なアクセント用
- **Lexend ExtraLight** - サブタイトル・軽い印象用
- **Lexend Light** - 本文・読みやすさ重視
- **Lexend Medium** - 見出し・重要テキスト用
- **Lexend SemiBold** - 強調・CTA用
- フォントURL: https://fonts.google.com/specimen/Lexend

### 3.2 フォント利用上の注意

- Adobe フォント、Google フォントなど使用可能
- Adobe フォントの場合は GW アカウントでの発行が必要なため、使用時は依頼を出すこと

### 3.3 サイズ・スケール

- ベースサイズ：
  - `sm: 14px`, `md: 16px`, `lg: 18px`
- 見出しスケール：
  - H1: 32→40→56
  - H2: 24→28→36
  - H3: 18→20→24
  - リード: 16→18→20（1.6行高）

---

## 4. コンポーネント設計（共通）

### 4.1 共通 UI

- **Container**: 幅制御＋左右 padding を内包。
- **Section**: `variant`（背景：`beige`, `navy`, `terra`, `white`）と `space`（上下余白）を props に持つ。
- **Heading**: `level, align, deco`（ラベル風/テープ風のデコ）
- **Card**: 画像上・横並び・説明・小ラベル・ナビ（1/2/3/…）などバリエーション。
- **Button/LinkButton**: `primary`（ネイビー）/`ghost`/`inverted`。
- **Badge/Label**: 手書き風テープを CSS で再現（before/after の角破れ）。
- **Carousel**: スマホはスワイプ（`aria-roledescription="carousel"`）。

### 4.2 画像

- `aspect-[ratio]` を多用。Hero 16:9、製品カード 3:4、スクエア 1:1。
- `img` は `loading="lazy"`、`decoding="async"`、`srcset/sizes` 指定。

---

## 5. セクション別仕様

### 5.1 Hero

- **背景**: 深藍 `bg-navy`。フルブリード。上部に小さなヘッダーナビ（ロゴ+右上ミニリンク）。
- **高さ**: `sm: ~56vh`, `md+: 70vh`（画像縦比に応じて `min-h-[560px]`）
- **要素**:
  - 左右中央寄せのファミリー画像（`object-cover`）。
  - 右上：`text-white/80` の極小ナビ（2–3リンク）。
- **内部余白**: `pt-6 md:pt-8 pb-8 md:pb-12`。

### 5.2 イントロコピー（手書きラベル）

- 背景：`bg-beige`。
- ラベル画像 or CSS ラベル（回転 1–2deg）＋短いコピー2行。
- 幅：`max-w-prose` 中央寄せ。
- 余白：`py-12 md:py-16`。

### 5.3 ハイライトギャラリー

- 背景：`bg-beige` 継続。
- **Desktop**：3カラム（`gap-6`）。**Mobile**：横スクロール（snap）。
- 各サムネは `rounded-xl shadow-sm hover:shadow-md`。

### 5.4 Product Lines（導入バナー）

- 背景：`bg-beige`→上に細長いバナー（斜めテープ演出）。
- バナー高さ：`72–96px`。
- タイポはオールキャップ、アクセントに **TNFブルー**。

### 5.5 2025FW コレクション（カード・カルーセル × 段構成）

- 背景：**紙色ベージュ** と **テラコッタ** を段ごとに切替。カードの下に“テープ紙片”を散らす演出。
- 各段：左右に 2〜3 枚の **製品カード**（画像 + タイトル + 説明 + 小ナビ 1–5）。
- **カード**
  - 幅：`sm: full`, `md: 48%`, `lg+: 31–48%` をケースで使い分け。
  - 画像比：3:4（`aspect-[3/4]`）。
  - 内部：タイトル（H3 20→24）、本文（14→16）。
  - フッターに **ページナビ（1/2/3/…）**：小円ボタン or 数字リンク。
- スクロール連動で軽いフェードアップ（`motion-reduce` 配慮）。

### 5.6 2CTA（ALL ITEMS / STAFF STYLING）

- 背景：**ネイビー**。
- 2ボタン横並び（`grid-cols-2`）／スマホは縦並び。
- ボタンは `rounded-full px-6 py-4 text-white`、ホバーで明度+2% 。

### 5.7 Baby Blanket Collection

- 背景：**ネイビー** 継続。
- サブ見出し（薄金 or 生成り）。
- 小カード4枚（1:1）を **モバイル2列、デスクトップ4列**。

### 5.8 ピックアップ製品カード 3列

- 背景：**ネイビー**。
- 3カード並び（`gap-8`）、各カードはアイコン的な製品写真＋キャプション2行。

### 5.9 ファミリー写真（フルブリード）

- 背景：**テラコッタ**（土壁）。
- 余白小さめで画面いっぱいに見せる（上下 `py-16 md:py-24`）。

### 5.10 フッター

- 背景：**ネイビー**。
- 2つの薄色 CTA（ラベル風ボタン）＋会社情報・著作権・リンク。
- コピーライトは `text-white/60`。

---

## 6. Astro ディレクトリ & テンプレート

```
src/
  layouts/
    BaseLayout.astro        // <html> 枠, meta, fonts, global.css 読み込み
  components/
    Container.astro
    Section.astro
    Heading.astro
    TapeLabel.astro         // テープ風ラベル
    ProductCard.astro
    Carousel.client.tsx     // スワイプ/ドット
    CTAButtons.astro
  pages/
    index.astro
  data/
    collection.ts           // JSON/TS で内容管理
styles/
  global.css                // Tailwind v4 @theme + ベース
  tape.css                  // テープ風デコ
public/
  images/
```

`index.astro` は `data/collection.ts` を読み込んでセクションを map 描画。文言や並び替えはデータ駆動。

---

## 7. データモデル（例）

```ts
// src/data/collection.ts
export type ProductCard = {
  id: string;
  title: string;
  body: string;
  image: string;
  cta?: { label: string; href: string };
  pager?: { current: number; total: number };
  bg?: 'beige' | 'terra' | 'paper';
};

export type Section =
  | { kind: 'hero'; image: string; nav: { label: string; href: string }[] }
  | { kind: 'intro'; labelImg?: string; lead: string[] }
  | { kind: 'gallery'; images: string[] }
  | { kind: 'banner'; title: string; subtitle?: string }
  | { kind: 'collection'; rows: ProductCard[][] }
  | { kind: 'cta2'; left: { label: string; href: string }; right: { label: string; href: string } }
  | { kind: 'blanket'; items: { image: string; title: string }[] }
  | { kind: 'pickup3'; items: { image: string; title: string; caption?: string }[] }
  | { kind: 'family'; image: string }
  | { kind: 'footer'; ctas: { label: string; href: string }[] };

export const page: Section[] = [
  {
    kind: 'hero',
    image: '/images/hero.jpg',
    nav: [
      { label: 'Shop', href: '#' },
      { label: 'Stories', href: '#' },
    ],
  },
  { kind: 'intro', lead: ['やさしさを、日常へ。', 'Parent-first, newborn-friendly.'] },
  { kind: 'gallery', images: ['/g1.jpg', '/g2.jpg', '/g3.jpg', '/g4.jpg'] },
  { kind: 'banner', title: 'PRODUCT LINES', subtitle: 'MATERNITY+' },
  {
    kind: 'collection',
    rows: [
      /* ProductCard[][] */
    ],
  },
  {
    kind: 'cta2',
    left: { label: 'ALL ITEMS', href: '#' },
    right: { label: 'STAFF STYLING', href: '#' },
  },
  {
    kind: 'blanket',
    items: [
      /* ...4 items... */
    ],
  },
  {
    kind: 'pickup3',
    items: [
      /* ...3 items... */
    ],
  },
  { kind: 'family', image: '/images/family.jpg' },
  {
    kind: 'footer',
    ctas: [
      { label: 'ケアガイド', href: '#' },
      { label: 'サイズ表', href: '#' },
    ],
  },
];
```

---

## 8. Tailwind v4 用 global.css（@theme）

```css
@import 'tailwindcss';

/* Tailwind v4: デザイントークン */
@theme {
  --color-navy: #0e2540;
  --color-beige: #efe5d6;
  --color-paper: #e7dac5;
  --color-terra: #9c6a4a;
  --color-blue: #1e75bb; /* TNF blue */
  --color-text: #1a1a1a;
  --color-muted: #6b6b6b;
  --color-white: #ffffff;
  --color-black: #000000;

  --shadow-card: 0 2px 8px rgba(0, 0, 0, 0.06);
  --shadow-card-strong: 0 8px 24px rgba(0, 0, 0, 0.12);

  --font-sans:
    'Noto Sans JP', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial,
    'Apple Color Emoji', 'Segoe UI Emoji';
  --font-serif: 'Cormorant Garamond', ui-serif, Georgia, Cambria, 'Times New Roman', serif;
}

:root {
  color: var(--color-text);
  background: var(--color-white);
}

html {
  scroll-behavior: smooth;
}
body {
  font-family: var(--font-sans);
}

/***** ユーティリティ補助 *****/
.container {
  @apply mx-auto px-4 md:px-6 lg:px-8;
  max-width: 1280px;
}
.section {
  @apply py-14 md:py-20 lg:py-24;
}
.bg-beige {
  background-color: var(--color-beige);
}
.bg-paper {
  background-color: var(--color-paper);
}
.bg-navy {
  background-color: var(--color-navy);
}
.bg-terra {
  background-color: var(--color-terra);
}
.text-muted {
  color: var(--color-muted);
}

/***** テープ風ラベル *****/
.label-tape {
  position: relative;
  display: inline-block;
  background: #f6f0e6;
  padding: 0.5rem 1rem;
  transform: rotate(-1.2deg);
  box-shadow: var(--shadow-card);
}
.label-tape:before,
.label-tape:after {
  content: '';
  position: absolute;
  width: 12px;
  height: 12px;
  background: #e9dfcf;
}
.label-tape:before {
  left: -6px;
  top: -6px;
  transform: rotate(12deg);
}
.label-tape:after {
  right: -6px;
  bottom: -6px;
  transform: rotate(-12deg);
}

/***** カルーセルのページャ（数字） *****/
.pager {
  @apply flex gap-2 text-sm;
}
.pager a {
  @apply rounded-md bg-white/80 px-2 py-1 hover:bg-white;
}
.pager .is-active {
  @apply font-semibold underline;
}
```

> 必要に応じ `@custom-variant` で `hocus`（hover+focus）など追加可能。

---

## 9. 背景アニメーション仕様（木の陰が揺れる）

### 9.1 要件

- Hero と一部ベージュ背景セクションに、**木漏れ日の陰がゆらぐ**淡いアニメ。
- **パフォーマンス最優先**：FPS 30 を上限、GPU 合成層で描画。
- ユーザー設定尊重：`prefers-reduced-motion: reduce` では **静止**。

### 9.2 技術選定

- 2案提示：
  - **A. WebGL（Three.js + カスタムシェーダ）** … 波形ノイズでソフトシャドウ。質感◎、コストやや高。
  - **B. CSS/SVG + Canvas 2D の擬似ノイズ** … 実装軽量、調整幅はやや狭い。
- 本件は**品質重視**につき **A案（Three.js）**を採用。

### 9.3 実装概要（A案）

- フルスクリーン透明 Canvas を **背景レイヤ**として配置（`position: absolute; inset: 0; pointer-events: none`）。
- Three.js で**平面一枚**にフラグメントシェーダを適用（camera は正射影）。
- シェーダは **フラクタル・オープンシンプルックスノイズ**で陰模様を生成し、時間でゆっくり流す。
- 背景色を入力（ベージュ/ネイビー上）し、**乗算ブレンド**で陰影のみを加算。

### 9.4 API/Props

- `<WavingShadow bg='beige' intensity={0.12} speed={0.05} scale={1.2} />`
  - `bg`: `beige | navy | terra | paper`
  - `intensity`: 影の濃さ（0–1）
  - `speed`: ノイズの進行速度
  - `scale`: ノイズスケール

### 9.5 TypeScript（クライアント島）

```ts
// src/components/WavingShadow.client.ts
import * as THREE from 'three';

export function mountWavingShadow(
  el: HTMLElement,
  opts: { color: string; intensity: number; speed: number; scale: number }
) {
  const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: false });
  const scene = new THREE.Scene();
  const camera = new THREE.OrthographicCamera(-1, 1, 1, -1, 0, 1);
  const geometry = new THREE.PlaneGeometry(2, 2);

  const uniforms = {
    uTime: { value: 0 },
    uIntensity: { value: opts.intensity },
    uSpeed: { value: opts.speed },
    uScale: { value: opts.scale },
    uShadow: { value: new THREE.Color('#000000') },
  };

  const material = new THREE.ShaderMaterial({
    uniforms,
    transparent: true,
    depthTest: false,
    depthWrite: false,
    fragmentShader: `
      precision highp float;
      uniform float uTime; uniform float uIntensity; uniform float uSpeed; uniform float uScale;

      // 2D simplex noise（短縮版）
      vec2 hash(vec2 p){ p = vec2(dot(p,vec2(127.1,311.7)), dot(p,vec2(269.5,183.3))); return -1.0 + 2.0*fract(sin(p)*43758.5453123); }
      float noise(in vec2 p){ const float K1=0.366025404; const float K2=0.211324865; vec2 i=floor(p+(p.x+p.y)*K1); vec2 a=p-i+(i.x+i.y)*K2; vec2 o=(a.x>a.y)?vec2(1.0,0.0):vec2(0.0,1.0); vec2 b=a-o+K2; vec2 c=a-1.0+2.0*K2; vec3 h=max(0.5-vec3(dot(a,a),dot(b,b),dot(c,c)),0.0); vec3 n=h*h*h*h*vec3( dot(a,hash(i+0.0)), dot(b,hash(i+o)), dot(c,hash(i+1.0)) ); return dot(n, vec3(70.0)); }

      void main(){
        vec2 uv = gl_FragCoord.xy / vec2(${'window.innerWidth.toFixed(1)'}, ${'window.innerHeight.toFixed(1)'});
        // タイルしにくいようにスケール違いのノイズを重ねる
        float t = uTime * uSpeed;
        float n = 0.0;
        n += noise(uv * uScale * 1.2 + vec2(t, 0.0)) * 0.6;
        n += noise(uv * uScale * 0.6 + vec2(0.0, t*0.8)) * 0.3;
        n += noise(uv * uScale * 2.4 + vec2(t*0.4, t*0.2)) * 0.1;
        float shade = smoothstep(0.4, 0.8, n);
        gl_FragColor = vec4(0.0, 0.0, 0.0, shade * uIntensity);
      }
    `,
  });

  const mesh = new THREE.Mesh(geometry, material);
  scene.add(mesh);

  el.appendChild(renderer.domElement);

  function resize() {
    const { clientWidth: w, clientHeight: h } = el;
    renderer.setSize(w, h, false);
  }
  const ro = new ResizeObserver(resize);
  ro.observe(el);
  resize();

  let raf = 0;
  let t0 = performance.now();
  const reduce = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
  function loop(t: number) {
    uniforms.uTime.value = reduce ? 0 : (t - t0) / 1000;
    renderer.render(scene, camera);
    raf = requestAnimationFrame(loop);
  }
  raf = requestAnimationFrame(loop);

  return () => {
    cancelAnimationFrame(raf);
    ro.disconnect();
    renderer.dispose();
    el.innerHTML = '';
  };
}
```

**使い方（Astro）**：

```astro
---
import { onMount } from 'astro/jsx-runtime';
import { mountWavingShadow } from '@/components/WavingShadow.client';
---

<div
  class="absolute inset-0 -z-10"
  client:load
  ref={(el) => {
    if (!el) return;
    mountWavingShadow(el, { color: '#000000', intensity: 0.12, speed: 0.05, scale: 1.2 });
  }}
>
</div>
```

> ネイビー上では `intensity` を 0.06–0.08 に下げると上品に見えます。

### 9.6 代替（B案：CSSノイズ）

- `radial-gradient` と `filter: blur()` の合成を `@keyframes` で緩やかに移動。
- 端末が旧式 or WebGL 不可判定時にフォールバック。

---

## 10. アクセシビリティ / SEO

- 画像に適切な `alt`。装飾は空 `alt`。
- カルーセルは `aria-live="polite"`、キーボード操作でページ移動可。
- コントラスト比 4.5:1 以上（ネイビー×白、ベージュ×濃色）。
- メタ：`og:image`、`twitter:card`、構造化データ（Product / Collection）。

---

## 11. パフォーマンス

- 画像は `webp/avif` と `sizes` 最適化、LCP 対象は優先読み込み。
- セクション単位で `client:visible` を使い、不要な JS を遅延。
- Three.js は **Dynamic Import** + 1インスタンス共有（必要箇所のみ）。

---

## 12. アナリティクス設定

### 12.1 Google Analytics & Tag Manager

すべての HTML ファイルに以下のタグを追加する必要があります：

1. **ファイルの先頭に追加：**

   ```ftl
   <#ftl output_format="HTML" auto_esc=true>
   ```

2. **`</head>` 直前に追加：**

   ```ftl
   <#include '/common/google-analytics.ftl'>
   ```

3. **`<body>` 直後に追加：**
   ```ftl
   <#include '/common/google-tagmanager_noscript.ftl'>
   ```

### 12.2 実装上の注意

- 上記の FTL ファイルは共通ファイルとして管理されているため、直接編集は不要
- タグの追加位置は厳密に守ること（特に Tag Manager の noscript タグの位置）

---

## 13. ディレクトリ構造

### 13.1 HTML ファイルの配置

**Goldwin:**

- **DESKTOP**: `/web/template/ja/full/page/`
- **MOBILE**: `/web/template/ja/lite/page/`

**TNF (The North Face):**

- **DESKTOP**: `/web/template/ja/full/page/tnf/`
- **MOBILE**: `/web/template/ja/lite/page/tnf/`

### 13.2 アセット（CSS/JS/画像）の配置

**Goldwin:**

- **ASSETS**: `/web/template/ja/full/page/static/full/`

**TNF (The North Face):**

- **ASSETS**: `/web/template/ja/full/page/static/full/tnf/`

### 13.3 重要な注意事項

1. **ユーザーエージェント切り替え**
   - PC、スマートフォン用それぞれのディレクトリを自動で読み込む仕組み
   - 1ソースで作成した場合でも、PC用・スマートフォン用の両方のディレクトリにファイルを格納する必要がある

2. **static ディレクトリの扱い**
   - static 配下はユーザーエージェント切り替えが行われない
   - 画像、JS、CSS は PC・スマートフォン共用可能

3. **ファイル配置の制限**
   - `/web/template/full/page/` 直下に画像や CSS ファイルを置いても読み込めない
   - 必ず `/web/template/full/page/static` 配下に設置すること

---

## 14. QA チェックリスト

- [ ] 主要3幅（390/768/1360）で視差・崩れなし
- [ ] `prefers-reduced-motion` 準拠
- [ ] 画像 `alt`/`width`/`height` 指定
- [ ] CLS < 0.1 / LCP < 2.5s（実機）
- [ ] カルーセルのフォーカスインジケータ表示
- [ ] カラートークンの参照漏れなし
- [ ] FTL タグが正しい位置に配置されている
- [ ] ディレクトリ構造が仕様通りに配置されている

---

### 補足：サイズ感の目安（カード）

- 画像：`sm 320×426`, `md 400×533`, `lg 480×640`（3:4）
- タイトル：`md 20px / lg 24px`、本文：`md 16px`
- カード内余白：`md 16–20px`、カード間 `gap-6`

以上。実装開始前の疑問点（フォント指定の厳密さ、手書きラベルの素材 or CSS 再現、カルーセル挙動など）があれば、追記します。
